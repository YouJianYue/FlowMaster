# -*- coding: utf-8 -*-
"""
正则相关常量
"""

# 用户名正则：长度 4-64，字母开头，支持字母、数字、下划线
USERNAME = r"^[a-zA-Z][a-zA-Z0-9_]{3,63}$"

# 密码正则模板：长度 min 到 max，必须包含数字和小写字母（或大写），支持任意字符
PASSWORD_TEMPLATE = r"^(?=.*\d)(?=.*[a-zA-Z]).{%s,%s}$"

# 密码正则：长度 8-32，必须包含数字和字母
PASSWORD = r"^(?=.*\d)(?=.*[a-zA-Z]).{8,32}$"

# 特殊字符正则：常见符号及换行符
SPECIAL_CHARACTER = (
    r"[-_`~!@#$%^&*()+=|{}':;',\\[\\].<>/?~！@#￥%……&*（）——+|{}【】‘；：”“’。，、？]"
    r"|\n|\r|\t"
)

# 通用编码正则：长度 2-30，字母开头，支持字母、数字、下划线
GENERAL_CODE = r"^[a-zA-Z][a-zA-Z0-9_]{1,29}$"

# 通用名称正则：长度 2-30，支持中文、字母、数字、下划线、短横线
GENERAL_NAME = r"^[\u4e00-\u9fa5a-zA-Z0-9_-]{2,30}$"

# 包名正则：支持多级包，每级以字母或下划线开头，用点分隔
PACKAGE_NAME = r"^(?:[a-zA-Z_][a-zA-Z0-9_]*\.)*[a-zA-Z_][a-zA-Z0-9_]*$"

# HTTP 域名 URL 正则：http:// 或 https:// + 域名 + 可选路径
HTTP_DOMAIN_URL = r"^(https?://)([a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}(\/[^\\s]*)?$"

# HTTP HOST 正则：支持域名、IPv4、IPv6（含压缩格式）
HTTP_HOST = (
    r"^("
    # ① 域名
    r"(?:[A-Za-z0-9](?:[A-Za-z0-9-]{0,61}[A-Za-z0-9])?\.)+[A-Za-z]{2,63}"
    r"|"
    # ② IPv4
    r"(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)"
    r"|"
    # ③ IPv6：完整 8 组
    r"(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}"
    r"|"
    # ④ IPv6：支持 ::
    r"(?:[0-9A-Fa-f]{1,4}:){0,6}::(?:[0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4}"
    r")$"
)

# ----------------------------
# 模块导出控制
# ----------------------------

__all__ = [
    "USERNAME",
    "PASSWORD_TEMPLATE",
    "PASSWORD",
    "SPECIAL_CHARACTER",
    "GENERAL_CODE",
    "GENERAL_NAME",
    "PACKAGE_NAME",
    "HTTP_DOMAIN_URL",
    "HTTP_HOST",
]
